---
import Layout from "../Layouts/BaseLayout.astro";
import { Image } from "astro:assets";
---

<script is:inline>
	const getThemePreference = () => {
		if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
			return localStorage.getItem('theme');
		}
		return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
	};
	const isDark = getThemePreference() === 'dark';
	document.documentElement.classList[isDark ? 'add' : 'remove']('dark');
 
	if (typeof localStorage !== 'undefined') {
		const observer = new MutationObserver(() => {
			const isDark = document.documentElement.classList.contains('dark');
			localStorage.setItem('theme', isDark ? 'dark' : 'light');
		});
		observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class'] });
	}
</script>

<Layout>
  <main class="flex flex-col items-center justify-center min-h-screen gap-4">
    <Image 
      id="artwork-img" 
      class="h-auto shadow w-96" 
      src="/artworks/placeholder.jpg" 
      alt="Artwork"
      width={384}
      height={384}
      format="webp"
	  loading="eager"

    />
	<script is:inline>
const artworks = [
  "1.png",
  "2.png",
  "3.png",
  "4.JPG",
  "4.png",
  "Evening memory 4.JPG",
  "IMG_0067 2.jpg",
  "IMG_0147 2.PNG",
  "IMG_0505 2.jpg",
  "IMG_0654 2.JPG",
  "IMG_0879 3.PNG",
  "IMG_0958.jpg",
  "IMG_8830.jpg",
];

	  function getRandomIndex(exclude) {
		let idx;
		do {
		  idx = Math.floor(Math.random() * artworks.length);
		} while (idx === exclude && artworks.length > 1);
		return idx;
	  }

	  let currentIndex = 0;
	  const imgEl = document.getElementById('artwork-img');
	  function showRandomArtwork() {
		currentIndex = getRandomIndex(currentIndex);
		imgEl.src = `/artworks/${artworks[currentIndex]}`;
	  }

	  imgEl.src = `/artworks/${artworks[0]}`;
	  currentIndex = 0;

	  setInterval(showRandomArtwork, 4000);
	</script>
  </main>
</Layout>
